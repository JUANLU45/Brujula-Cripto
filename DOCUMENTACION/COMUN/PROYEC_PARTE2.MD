# üü¶ PROYEC_PARTE2_FINAL_V3.MD (Frontend)

## 1. Stack Tecnol√≥gico (Sin cambios)

- **Framework:** Next.js 14+ (App Router)
- **Lenguaje:** TypeScript (`strict` mode)
- **Estilos:** Tailwind CSS
- ... (resto de tecnolog√≠as)

## 2. Principios de Dise√±o (Sin cambios)

- **Mobile-First** y **Accesibilidad (a11y)**.

## 3. Estructura de Carpetas y Nombres de Componentes (`packages/app`) - **ACTUALIZADO**

```
/packages/app/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ [locale]/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (main)/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx          # P√°gina de Inicio (Home)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ blog/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ [slug]/page.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ recuperacion/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page.tsx      # **Herramienta 1: M√≥dulo de Diagn√≥stico**
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ password/page.tsx # **Herramienta 2: Recuperaci√≥n de Contrase√±a**
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ herramientas/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tracker/page.tsx  # **Herramienta 4: Rastreador de Transacciones**
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ servicios/page.tsx # **Herramienta 5: Directorio de Servicios**
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ contacto/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx      # **P√°gina de Contacto**
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ seguridad/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx      # **Herramienta 3: Base de Conocimiento (Blog filtrado)**
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ registro/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx      # **Registro de Usuario**
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ login/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx      # **Inicio de Sesi√≥n**
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ recuperar-password/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx      # **Recuperaci√≥n de Contrase√±a de Cuenta**
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ suscripcion/
‚îÇ   ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ page.tsx      # **P√°gina de Precios y Suscripci√≥n**
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ legal/
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ aviso-legal/page.tsx
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ privacidad/page.tsx
‚îÇ   ‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ terminos/page.tsx
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ descargo-responsabilidad/page.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ (dashboard)/         # **Nueva Ruta Protegida**
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout.tsx       # Layout para √°rea protegida
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ cuenta/
‚îÇ   ‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ page.tsx     # **Panel de Control del Usuario**
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ not-found.tsx        # **P√°gina de Error 404**
...
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ ui/
‚îÇ   ‚îú‚îÄ‚îÄ layout/
‚îÇ   ‚îî‚îÄ‚îÄ features/
‚îÇ       ‚îú‚îÄ‚îÄ admin/
‚îÇ       ‚îú‚îÄ‚îÄ recovery/
‚îÇ       ‚îú‚îÄ‚îÄ blog/           # ArticleCard.tsx, ArticleList.tsx, BlogSearchBar.tsx, PaginationControls.tsx
‚îÇ       ‚îú‚îÄ‚îÄ payments/
‚îÇ       ‚îú‚îÄ‚îÄ homepage/       # HomepageBanner.tsx, FeaturedPostsCarousel.tsx
‚îÇ       ‚îú‚îÄ‚îÄ tools/          # TransactionTracker.tsx, ServiceDirectory.tsx
‚îÇ       ‚îú‚îÄ‚îÄ contact/        # ContactForm.tsx
‚îÇ       ‚îú‚îÄ‚îÄ auth/           # **NUEVO** SignUpForm.tsx, SignInForm.tsx, PasswordResetForm.tsx
‚îÇ       ‚îú‚îÄ‚îÄ pricing/        # **NUEVO** PricingPage.tsx
‚îÇ       ‚îî‚îÄ‚îÄ dashboard/      # **NUEVO** UserDashboard.tsx
...
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îî‚îÄ‚îÄ api.ts              # L√≥gica para llamar a backend y miniservicios
```

## 4. Mejoras Implementadas para Robustez y Producci√≥n 2025

### **A. Escalabilidad del `TransactionTracker`**

- **Descripci√≥n:** En `TransactionTracker.tsx`, a√±adir l√≥gica de reintentos con backoff exponencial
  para llamadas a APIs externas. Usar librer√≠a `retry-axios` en el frontend para manejar fallos, con
  m√°ximo 3 reintentos y delay inicial de 1s. No altera estructura existente.

### **B. Mapeo de Autenticaci√≥n con Google OAuth**

- **Descripci√≥n:** En `SignInForm.tsx`, aclarar mapeo: Al autenticar con Google, usar
  `firebase.auth().signInWithPopup(googleProvider)` y mapear `uid` directamente a `stripeCustomerId`
  en Firestore v√≠a hook post-login. A√±adir en documentaci√≥n de componente.

### **C. Feedback en Formularios**

- **Descripci√≥n:** En componentes como `SignUpForm.tsx`, `SignInForm.tsx`, `PasswordResetForm.tsx` y
  `ContactForm.tsx`, integrar mensajes de error localizados (ES/EN) usando `react-hook-form` con
  resolvers para validaciones como "email ya registrado" o "contrase√±a d√©bil". Estados de error
  visibles con Tailwind classes.

### **D. P√°gina del Blog (`/blog`)**

- **Componente Principal:** `BlogPage.tsx`
- **Estructura:** Banner superior con H1 ("Explora Nuestro Blog de Cripto Seguridad"), H2 ("Gu√≠as,
  Noticias y Consejos Expertos"), descripci√≥n llamativa ("Mantente al d√≠a con las mejores pr√°cticas
  en criptomonedas"). Barra de b√∫squeda (`BlogSearchBar.tsx`) para filtrar por
  t√≠tulo/tags/categor√≠as. Lista de tarjetas (`ArticleList.tsx`) con paginaci√≥n
  (`PaginationControls.tsx`). Cada tarjeta (`ArticleCard.tsx`) con imagen de portada, t√≠tulo,
  excerpt, tags clicables (enlazan a art√≠culos de misma tag/categor√≠a), botones de compartir en
  redes (usando Web Share API nativa para X, Telegram, etc.). Solo suscritos
  (`hasPremiumAccess: true`) pueden dar like (almacenado en Firestore) y enviar comentarios
  (moderados v√≠a admin).
- **SEO Enfocado:** Usar Next.js metadata API para metaetiquetas din√°micas por p√°gina, canonical
  links, structured data (JSON-LD para articles). Categor√≠as din√°micas gestionadas desde admin
  (`/admin/articles`).

### **E. P√°gina de Art√≠culo Individual (`/blog/[slug]` )**

- **Componente:** `ArticlePage.tsx`
- **Estructura:** Dise√±o limpio para lectura f√°cil (Tailwind prose), con H1 (t√≠tulo), meta info
  (autor, fecha, categor√≠a), contenido Markdown renderizado. Tags clicables (enlazan a lista de
  art√≠culos por tag). Flechas de navegaci√≥n para art√≠culo anterior/siguiente. Botones de compartir
  en redes (Web Share API). Solo suscritos pueden dar like y comentarios. Enlace a categor√≠a para
  ver m√°s art√≠culos relacionados.

### **F. Comparaci√≥n Interactiva en Suscripci√≥n (`CompetitorComparison.tsx` )**

- **Descripci√≥n:** En `/suscripcion/page.tsx`, a√±adir componente interactivo: Tabs para diferencias
  (privacidad, ecosistema, facilidad). Calculadora para costos: Input para monto recuperado, calcula
  20% competidores vs fijo/hora...(truncated 3354 characters)...xto, imagen.

### **B. P√°gina de Diagn√≥stico Interactivo (`/recuperacion` )**

- **Componente:** `RecoveryWizard.tsx`.
- **Interacci√≥n:** Una serie de tarjetas con preguntas comunes, como "He perdido mi contrase√±a"
  (enlaza a `/recuperacion/password`).

### **C. P√°gina de Recuperaci√≥n de Contrase√±a (`/recuperacion/password` )**

- **Componente:** `WasmPasswordEngine.tsx`.
- **Interacci√≥n:** Formulario para introducir datos (ej. diccionarios), con niveles gratuito
  (limitado) y premium (ilimitado). Muestra progreso y resultados.

### **D. P√°gina de Gu√≠as de Seguridad (`/seguridad` )**

- **Componente:** `SecurityGuides.tsx`.
- **Interacci√≥n:** Lista filtrada del blog por categor√≠a "seguridad".

### **E. P√°gina de Rastreador de Transacciones (`/herramientas/tracker` )**

- **Componente:** `TransactionTracker.tsx`.
- **Interacci√≥n:** Formulario para introducir hash de transacci√≥n o direcci√≥n, muestra resultados
  detallados de APIs externas.

### **F. P√°gina de Directorio de Servicios (`/herramientas/servicios` )**

- **Componente:** `ServiceDirectory.tsx`.
- **Interacci√≥n:** Lista de servicios profesionales con filtros por especialidad.

### **G. P√°ginas Legales (`/legal/*` )**

_Estas p√°ginas son fundamentales y deben estar perfectamente redactadas._

1. **Aviso Legal, Privacidad, T√©rminos y Condiciones:** P√°ginas de texto est√°tico con el contenido
   legal correspondiente.
2. **Descargo de Responsabilidad (`/legal/descargo-responsabilidad`):**
   - **Contenido:** Esta p√°gina contendr√° un texto **enorme y muy claro** explicando que Br√∫jula
     Cripto es una herramienta de software, que no garantiza la recuperaci√≥n, que no es un servicio
     de custodia, que no ofrece consejo financiero y que el uso de las herramientas es bajo la
     propia responsabilidad del usuario.
   - **Visibilidad:** El enlace a esta p√°gina estar√° en el footer y en cualquier lugar donde se
     ofrezca un servicio de pago o de riesgo.

### **H. P√°gina de Contacto (`/contacto` )**

- **Componente:** `ContactForm.tsx`.
- **Interacci√≥n:** Formulario para enviar nombre, email y mensaje, que se procesa a trav√©s de una
  Cloud Function.

### **I. P√°gina del Blog (`/blog` )**

- **Componente Principal:** `BlogPage.tsx`
- **Estructura:** Banner superior editable desde admin (foto, texto H1/H2, descripci√≥n). Barra de
  b√∫squeda para t√≠tulos/tags/categor√≠as. Lista paginada de tarjetas con sharing nativo,
  likes/comentarios solo para suscritos. Categor√≠as din√°micas editables desde admin.

### **J. P√°gina de Art√≠culo (`/blog/[slug]` )**

- **Componente:** `ArticlePage.tsx`
- **Estructura:** Contenido f√°cil de leer, tags clicables, flechas para navegaci√≥n, sharing nativo,
  likes/comentarios para suscritos.

### **K. P√°gina del Chatbot (`/chatbot` )**

- **Componente:** `ChatbotUI.tsx`
- **Estructura:** Interfaz espectacular con imagen de br√∫jula como logo, nombre "Br√∫jula".
  Conversaciones listadas, respuestas streaming, sugerencias, render components (tablas/tarjetas).

### **L. P√°gina de Suscripci√≥n (`/suscripcion` )**

- **Componente Principal:** `PricingPage.tsx`
- **Interacci√≥n:** Tabla de precios, secci√≥n interactiva de diferencias con calculadora para
  demostrar valor superior (comparaci√≥n costos, privacidad, ecosistema), mostrando num√©ricamente por
  qu√© somos mejores (e.g., ahorros calculados en tiempo real).

## 3. Flujo de Pago y Consentimiento (Monetizaci√≥n)

_La legalidad y la claridad en el pago son innegociables._

1. **Oferta:** En la p√°gina de la herramienta de recuperaci√≥n de contrase√±as, junto al Nivel
   Gratuito, se mostrar√° claramente la oferta del Nivel Premium (`PricingTier.tsx`).
2. **Consentimiento Expl√≠cito:** Junto al bot√≥n de pago (`UpgradeButton.tsx`), habr√° una **casilla
   de verificaci√≥n (checkbox) obligatoria** con el siguiente texto:
   - > `‚òê He le√≠do y acepto los [T√©rminos y Condiciones](/legal/terminos) y entiendo el [Descargo de Responsabilidad](/legal/descargo-responsabilidad), reconociendo que el pago desbloquea la herramienta de software sin garant√≠a de √©xito en la recuperaci√≥n.`
3. **Proceso:** El bot√≥n de pago solo se activar√° una vez que el usuario marque esta casilla.
4. **Visibilidad:** El enlace al descargo de responsabilidad estar√° siempre visible durante todo el
   proceso de uso de la herramienta de recuperaci√≥n.

## 4. P√°ginas de Administraci√≥n (`/admin/*`)

- **Acceso:** Protegido por una p√°gina de login (`/admin/auth`).
- **Dashboard (`/admin`):** Vista general de los √∫ltimos art√≠culos, borradores pendientes y
  estad√≠sticas.
- **Gesti√≥n de Art√≠culos (`/admin/articles`):**
  - Una tabla (`ArticleDataTable.tsx`) para ver, filtrar, editar y eliminar todos los art√≠culos
    (manuales y de la IA).
  - Un bot√≥n para crear un nuevo art√≠culo, que lleva al editor.
- **Editor de Art√≠culos (`/admin/articles/[id]`):**
  - El editor `TipTap` (`ArticleEditor.tsx`) para modificar el contenido, cambiar el estado
    (Borrador/Publicado), a√±adir enlaces de afiliado y cambiar la imagen de portada.
- **Gesti√≥n de Contenido de la Home:** Una nueva secci√≥n en el admin para editar los campos del
  documento `siteContent/homepage` (el banner, etc.).

## 5. Mejoras Implementadas para Robustez y Producci√≥n 2025

### **A. Pruebas de Usabilidad del RecoveryWizard**

- **Descripci√≥n:** En p√°gina `/recuperacion`, integrar pruebas A/B: Usar Vercel o Optimizely para
  variar texto/orden de tarjetas en `RecoveryWizard.tsx`, midiendo conversi√≥n a herramientas.
  Registrar m√©tricas en Firestore para an√°lisis.

### **B. Dise√±o Discreto para Saturaci√≥n de Enlaces Legales**

- **Descripci√≥n:** En `Footer.tsx`, para m√≥vil, implementar acorde√≥n con Tailwind para colapsar
  enlaces legales (Columna 2), expandible con click. Mantener visibilidad pero reducir sobrecarga
  visual.

### **G. Adaptaci√≥n al Modelo de Pago por Horas en UI**

- **Descripci√≥n:** En `/suscripcion/page.tsx`, transformar en "Planes por Hora" con paquetes de
  compra √∫nica. En `/cuenta/page.tsx`, mostrar tiempo restante (H:M:S) y historial de compras. En
  herramientas como `WasmPasswordEngine.tsx` y `ChatbotUI.tsx`, a√±adir contador en tiempo real que
  se actualiza v√≠a API calls a trackUsage. Cr√©ditos iniciales: 15 min para herramientas, 30 min para
  chatbot en registro.

### **H. Calculadora de Precios Actualizada**

- **Descripci√≥n:** En `CompetitorComparison.tsx`, agregar inputs para "Monto a recuperar (‚Ç¨)" y
  "Horas estimadas". C√°lculo: Competencia = monto _0.20; Nuestro = (min(2, horas)_ 4.99) + (max(0,
  horas - 2) \* 3.99). Mostrar ahorros.

### **I. Gesti√≥n del Banner en Admin**

- **Descripci√≥n:** En `/admin/homepage`, nuevo componente para editar banner: Subir imagen de fondo,
  editar texto principal, imagen superpuesta, texto/enlace del bot√≥n. Almacenar en
  `siteContent/homepage`.

### **J. Gesti√≥n de Mensajes de Feedback en Admin**

- **Descripci√≥n:** En `/admin/feedback`, tabla para ver mensajes de `FeedbackButton.tsx`. Funciones:
  Leer todos, eliminar individual, eliminaci√≥n masiva v√≠a selecci√≥n.

### **K. Editor Avanzado de Blog en Admin**

- **Descripci√≥n:** En `ArticleEditor.tsx`, a√±adir: Editor enriquecido manual, programaci√≥n
  (inmediata/manual/autom√°tica con fecha/hora), gesti√≥n categor√≠as (crear/editar/eliminar
  din√°micas), tags m√∫ltiples. IA: Prompt para texto (Gemini Pro), prompt para im√°genes (DALL-E 3,
  almacenar en Firebase Storage), upload manual. Opciones: Tama√±o (800/1200/1600 palabras), a√±adir
  Q&A/conclusiones/recomendaciones, modo profundidad (Profundo/General).

### **L. Moderaci√≥n de Comentarios en Admin**

- **Descripci√≥n:** En `/admin/comments`, vista para ver/eliminar comentarios individualmente.
  Integrar moderaci√≥n IA autom√°tica en microservicio (an√°lisis con OpenAI Moderation),
  marcar/eliminar basado en config admin.
